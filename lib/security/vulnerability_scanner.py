import subprocess
from typing import List, Dict
import json

class VulnerabilityScanner:
    def scan_package(self, package_path: str) -> List[Dict]:
        """Сканирование пакета на уязвимости"""
        try:
            result = subprocess.run(
                ["trivy", "filesystem", "--format=json", package_path],
                capture_output=True,
                text=True
            )
            return json.loads(result.stdout)
        except Exception as e:
            print(f"Scan failed: {e}")
            return []

    def check_dependencies(self, requirements_file: str) -> Dict:
        """Проверка зависимостей на уязвимости"""
        try:
            result = subprocess.run(
                ["dependency-check", "--scan", requirements_file, "--format=JSON"],
                capture_output=True,
                text=True
            )
            return json.loads(result.stdout)
        except Exception as e:
            print(f"Dependency check failed: {e}")
            return {}
